---
title: "브라우저에 URL을 쳤을 때 무슨 일이 일어날까"
date: 2024-07-24
update: 2024-07-24
tags:
  - Network
  - Interview
---

1. 예를들어 브라우저에 https://www.naver.com 인 URL을 입력하고 Enter 키를 누릅니다.
2. 브라우저는 해당 URL을 파싱합니다. (https는 통신 프로토콜로 TLS를 사용하여 서버에 연결하도록 지시합니다. / 도메인 / 경로 / 리소스)  
3. 브라우저는 도메인의 IP 주소를 알아내기 위해 먼저, **브라우저 캐시를 확인하고 없으면 hosts 파일과 OS 캐시를 확인**합니다.
4. 여기에도 없다면 DNS 서버에게 IP 주소를 질의합니다.
5. 먼저 로컬 DNS 서버는 캐시를 확인하고 없으면 **Root Name Server**에게 com이 있는 **TLD Name Server** 주소를 받습니다.
6. 그리고 **TLD Name Server에서 sub domain Name Server 주소를 받고** sub domain Name Server에서 IP 주소를 받게 되고 최종적으로 브라우저에게 도착하게 됩니다.
7. IP 주소를 받은 웹 브라우저가 서버와의 TCP 연결을 시작하기 위해 **요청 패킷을 TCP/IP 라는 전송제어 프로토콜을 사용하여 라우터 장비와 ISP를 통해 이동**하는데 **라우팅 테이블을 사용하여
   최적의 경로를 찾아 목적지 IP 주소를 가진 웹 서버에 도달**합니다. 
8. 하지만, 웹 서버에 직접 도달하는 방법은 위치에 따라 효율적이지 않을 수도 있습니다. 요즘에는 많은 웹사이트들이 직접 서버에 연결하기 보다는 **CDN을 사용하여 정적 및
   동적 콘텐츠를 웹 브라우저에 가까이 위치** 시킵니다. 
9. 브라우저는 서버와의 **TCP 연결을 시작**합니다. 이때 TCP는 **3-way handshake** 방식으로 연결합니다. 
10. HTTPS 프로토콜의 경우 추가적으로 **TLS Handshake**를 수행합니다.
11. 웹 브라우저가 서버에 연결되면, 웹 브라우저가 페이지의 콘텐츠를 응답받기 위해 서버에 HTTP 요청을 전송하는 것으로 시작합니다. 
12. 더 자세히 말하면, 먼저 **웹브라우저가 요청라인, 헤더 및 본문이 포함된 HTTP 메시지를 생성**합니다. 
13. 이를 **SOCKET 라이브러리를 통해 OS에 전달하고 HTTP 메세지가 포함된 TCP/IP 패킷을 생성**합니다.
14. 그리고 네트워크 인터페이스 (NIC)를 통해 인터넷으로 빠져나갑니다. 
15. 서버는 받은 패킷안에 HTTP 메세지를 확인하고 올바른 요청일 경우 요청에 대한 응답을 생성하고 클라이언트에게 보냅니다.
16. 웹 브라우저가 서버로 부터 응답을 받으면 **응답 헤더를 검사하여 리소스를 렌더링하는 방법에 대한 정보를 확인**합니다. 만약 Content-Type이 HTML인 경우,
17. 브라우저는 HTML을 파싱하고 렌더링 합니다.
18. **만약, 동적인 컨텐츠를 요청할 때** 웹 서버는 클라이언트의 요청을 **웹 애플리케이션 서버에 전달**합니다.
19. WAS는 관련된 **Servlet을 메모리에 올리고, 해당 Servlet에 대한 Thread를 생성**합니다. 그리고 `HttpServletRequest`와 `HttpServletResponse` 객체를 생성하여 Servlet에 전달합니다.
20. Thread는 Servlet의 service() 메소드를 호출하고, doGet(), doPost() 메소드를 호출하여 **인자에 맞게 생성된 동적 페이지를 Response 객체에 담아 WAS에** 전달합니다. 
21. WAS는 Response 객체를 **HttpResponse 형태로 바꾸고 Web Server에 전달**합니다.
22. Web Server는 결과를 클라이언트에게 전달합니다.